<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head;
         any other head content must come *after* these tags -->

    <!-- Icon to use on the browser bar -->
    <link rel="icon" href="calendar/images/web-icon.png">

    <!-- Bootstrap core CSS -->
    <link href="calendar/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Skeleton CSS -->
    <link rel="stylesheet" href="calendar/Skeleton/css/normalize.css">
    <link rel="stylesheet" href="calendar/Skeleton/css/skeleton.css">
    <link rel="stylesheet" href="calendar/css/skeleton-modifications.css">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="calendar/bootstrap3-ie10-viewport-bug-workaround/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Fonts -->
    <link href='calendar/fonts/raleway.css' rel='stylesheet' type='text/css'>

    <!-- Ace Code Editor - https://ace.c9.io/ -->
    <script type="text/javascript" src="calendar/ace-builds/src-noconflict/ace.js" charset="utf-8">
    </script>

    <!-- Chart.js - http://www.chartjs.org -->
    <script type="text/javascript" src="calendar/chartjs/Chart.bundle.min.js" charset="utf-8">
    </script>

    <!-- To support challenge/response authentication within course notes-->
        <script type="text/javascript">
      var nonce = "3fde3a58a08a0469b75136bfdc2954319d0174b01f97bfcbe8486cb955887d14";
    </script>
    <script type="text/javascript" src="calendar/js/sha256.js"></script>
    
    <!-- Styles for the submission System -->
    <link href="calendar/css/calendar-default.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ["\\(","\\)"] ],
          processEscapes: true
        }
      });
    </script>
    <script type="text/javascript" src="../../ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>

    <!-- Highlight.js -->
    <link rel="stylesheet" href="calendar/highlight/styles/color-brewer.css">
    <script src='calendar/highlight/highlight.pack.js'></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- Font-Awesome -->
    <link rel="stylesheet" type="text/css" href="calendar/Font-Awesome/css/font-awesome.min.css">

    <!-- Datatables -->
    <link rel="stylesheet" type="text/css" href="calendar/datatables.net/datatables.min.css">

    <!-- Printing -->
    <link rel="stylesheet" type="text/css" media="print" href="calendar/css/calendar-print.css">

    <!-- Custom CSS based on user preferences -->
    <link href='docs/sy110_cdrD.css' rel='stylesheet'>
      
      
    <!-- Custom JavaScript based on user preferences -->

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="calendar/jquery/js/jquery-3.3.1.min.js"></script>
    <script src="calendar/bootstrap/js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="calendar/bootstrap3-ie10-viewport-bug-workaround/ie10-viewport-bug-workaround.js"></script>
    <!-- DataTables -->
    <script type="text/javascript" src="calendar/datatables.net/datatables.min.js"></script>

  <title>CYBERWAR (Fall 2020)</title>

  </head>
  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <!--
            <a class="navbar-brand" href="#">
              <img alt="Navbar!" src="css/images/web-icon.png" width="24">
            </a>
          -->
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li><a href="calendar.php.html?load=home">
                CYBERWAR - Introduction to Cyber Security</a></li>

            
            <li><a title="Calendar" href="calendar.php-1.html?show=calendar_display">
                <span class="glyphicon glyphicon-calendar" aria-hidden="true"></span>
                </a></li>

            <li><a title="Resources" href="calendar.php-2.html?load=resources">
                <span class="glyphicon glyphicon-briefcase" aria-hidden="true"></span>
                </a></li>

            <li><a title="Information" href="calendar.php-3.html?load=policy">
                <span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
                </a></li>

        
        
          </ul>

        
          <ul class="nav navbar-nav navbar-right">
            <li class="dropdown">
<a href="#" title="View files associated with lecture" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
Digital Certificates
</a>
<ul class="dropdown-menu  scrollable-menu">
<li class="dropdown-header">Options</li>
<li><form method="post" class="navbar-form navbar-left" role="search" target="_blank">
  <div class="input-group">
    <input type="hidden" class="form-control" name="print" id="print">
    <div class="input-group-btn">
        <button class="btn btn-default" type="submit"><i class="glyphicon glyphicon-print"></i> Print</button>
    </div>
  </div>
</form></li>
<li><form method="get" class="navbar-form navbar-left" role="search">
  <div class="input-group">
    <input type="hidden" name="show" value="calendar_search">
    <input type="text" class="form-control" placeholder="Search" name="search" id="search">
    <div class="input-group-btn">
        <button class="btn btn-default" type="submit"><i class="glyphicon glyphicon-search"></i></button>
    </div>
  </div>
</form></li>
<li><form method="post" class="navbar-form navbar-left" role="search" onsubmit="return hashPassword()">
  <div class="input-group">
    <input type="password" class="form-control" placeholder="Password" name="password" id="password">
    <div class="input-group-btn">
        <button class="btn btn-default" type="submit"><i class="glyphicon glyphicon-lock"></i></button>
    </div>
</div>
</form></li>
</ul>
</li>
            <li class="dropdown">
              <a href="#" title="Select class" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                <span class="glyphicon glyphicon-apple" aria-hidden="true"></span>
                Class<span class="caret"></span></a>
              <ul class="dropdown-menu  scrollable-menu">
                <li><a href='calendar.php-4.html?type=class&event=1'>1 - Intro to the Cyber Domain</a></li>
<li><a href='calendar.php-5.html?type=class&event=2'>2 - Aspects and Pillars of Cyber Security</a></li>
<li><a href='calendar.php-6.html?type=class&event=3'>3 - Computer Architecture</a></li>
<li><a href='calendar.php-7.html?type=class&event=4'>4 - Risk And Vulnerabilities</a></li>
<li><a href='calendar.php-8.html?type=class&event=5'>5 - Policy And Law</a></li>
<li><a href='calendar.php-9.html?type=class&event=6'>6 - Bits And Bytes And Files</a></li>
<li><a href='calendar.php-10.html?type=class&event=7'>7 - OS-File Systems</a></li>
<li><a href='calendar.php-11.html?type=class&event=8'>8 - OS-Permissions, Shell, And Remote Access</a></li>
<li><a href='calendar.php-12.html?type=class&event=9'>9 - Web And HTML</a></li>
<li><a href='calendar.php-13.html?type=class&event=10'>10 - JavaScript - Overview</a></li>
<li><a href='calendar.php-14.html?type=class&event=11'>11 - Vulnerabilities and Malware</a></li>
<li><a href='calendar.php-15.html?type=class&event=12'>12 - Cyberspace as a Human Domain</a></li>
<li><a href='calendar.php-16.html?type=class&event=13'>13 - Client-Side Scripting: Part One</a></li>
<li><a href='calendar.php-17.html?type=class&event=14'>14 - Client-Side Scripting: Part Two</a></li>
<li><a href='calendar.php-18.html?type=class&event=15'>15 - Server-Side Scripting</a></li>
<li><a href='calendar.php-19.html?type=class&event=16'>16 - Human Factors in Cyber Operations</a></li>
<li><a href='calendar.php-20.html?type=class&event=17'>17 - Stack-Intro and Physical Layer</a></li>
<li><a href='calendar.php-21.html?type=class&event=18'>18 - Stack - Data Link Layer</a></li>
<li><a href='calendar.php-22.html?type=class&event=19'>19 - Stack - Network Layer</a></li>
<li><a href='calendar.php-23.html?type=class&event=20'>20 - Stack - Transport Layer</a></li>
<li><a href='calendar.php-24.html?type=class&event=21'>21 - Stack - Application Layer</a></li>
<li><a href='calendar.php-25.html?type=class&event=22'>22 - Wireless</a></li>
<li><a href='calendar.php-26.html?type=class&event=23'>23 - Network Security Appliances and Firewalls</a></li>
<li><a href='calendar.php-27.html?type=class&event=24'>24 - Symmetric Encryption</a></li>
<li><a href='calendar.php-28.html?type=class&event=25'>25 - Asymmetric Encryption</a></li>
<li><a href='calendar.php-29.html?type=class&event=26'>26 - Steganography</a></li>
<li><a href='calendar.php-30.html?type=class&event=27'>27 - Digital Forensics</a></li>
<li><a href='calendar.php-31.html?type=class&event=28'>28 - Cyber Recon</a></li>
<li><a href='calendar.php-32.html?type=class&event=29'>29 - Attackers And Defenders</a></li>
<li><a href='calendar.php-33.html?type=class&event=30'>30 - Cyber Attack</a></li>
<li><a href='calendar.php-34.html?type=class&event=31'>31 - Cyber Defense</a></li>
              </ul>
            </li>
                        <li class="dropdown">
              <a href="#" title="Select lab" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                <span class="glyphicon glyphicon-knight" aria-hidden="true"></span>
                Lab<span class="caret"></span></a>
              <ul class="dropdown-menu  scrollable-menu">
                <li><a href='calendar.php-35.html?type=lab&event=1'>1 - Computer Architecture And Supply Chain</a></li>
<li><a href='calendar.php-36.html?type=lab&event=2'>2 - Windows-Unix Shell And Command Line</a></li>
<li><a href='calendar.php-37.html?type=lab&event=3'>3 - Introduction to Build a Website</a></li>
<li><a href='calendar.php-38.html?type=lab&event=4'>4 - Injection Attacks and XSS</a></li>
<li><a href='calendar.php-39.html?type=lab&event=5'>5 - LAN-WLAN</a></li>
<li><a href='calendar.php-40.html?type=lab&event=6'>6 - Hashing And Passwords</a></li>
<li><a href='calendar.php-41.html?type=lab&event=7'><font color='black'><b>7 - Digital Certificates</b></font></a></li>
<li><a href='calendar.php-42.html?type=lab&event=8'>8 - Digital Forensics</a></li>
<li><a href='calendar.php-43.html?type=lab&event=9'>9 - Cyber Recon</a></li>
<li><a href='calendar.php-44.html?type=lab&event=10'>10 - Cyber Attack</a></li>
<li><a href='calendar.php-45.html?type=lab&event=11'>11 - Cyber Defense</a></li>
<li><a title='Material not online at this time' href='#'><span style='color=#AAAAAA'>12 - _archive</span></a></li>
              </ul>
            </li>
            
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

  <!-- End TopBar and CSS Stuff! -->
<!-- Begin providing the contents of the page -->
<div class="container">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
    <title>BRAND: Digital Certificates</title>

    <script type="text/javascript">
      function swirl() {
        R=0; x1=.1; y1=.05; x2=.25; y2=.24; x3=1.6; y3=.24; x4=300;
        y4=200; x5=300; y5=200; DI=document.getElementsByTagName("img");
        DIL=DI.length;
        setInterval('A()',50);
        void(0);
      }
      function A() {
        for (i=0; i-DIL; i++) {
          DIS=DI[ i ].style;
          DIS.position='absolute';
          DIS.left=(Math.sin(R*x1+i*x2+x3)*x4+x5)+"px";
          DIS.top=(Math.cos(R*y1+i*y2+y3)*y4+y5)+"px";
        }
        R++;
      }
    </script>
    <style>
      .key { font-size:0.8em; margin-left: -0.3em; }
      .own { font-size:0.8em; }
    </style>

  </head>
  <body>
  
    <div class="noScreen">
      <h1>Digital Certificates</h1>
    </div>
    
<!--Instructor information-->


      <div class="sec">
        <p>
          We will do the condensed version of the <a href="calendar.php-101.html?key=607d67f7406e34dd3a942663183788407bde3cd7&type=lab&event=7"><strong>Digital Certificates Lab Activity</strong></a> this semester (Spring AY2019). The lab and the instructor demos that proceed it all revolve around a very basic, profound problem &mdash; asymmetric encryption provides us with tools that guarantee confidential, non-repudiated communication between <em>owners of keys</em>. What it doesn't provide is a way of guaranteeing that the entity behind that public key is who we think it is. That's what X.509 certificates and other similar systems are for.
          
          
          
      </p></div>

        <p class="sec">
    <h2>Man-in-the-middle attacks</h2>
    <em>Man-in-the-middle</em> is a form of attack that can be carried out in a variety of scenarios.  We will describe it in terms of attacking RSA, though this is just one kind of man-in-the-middle attack.
    <p>
      <img src="calendar.php-62.png?key=5ae88d3e3f876aa35c9118a96e6407e334470093&type=lab&event=7" style="height: 200pt; float: right; clear: right;">
      RSA guarantees us the following:  you can carry on  communication with the owner of public key K<sub class="key">pub</sub> and be sure that:
      <ol>
        <li>messages you receive can only be read by you, and can only have come form the owner of K<sub class="key">pub</sub></li>
        <li>messages you send can only be read by the owner of K<sub class="key">pub</sub>, and the owner of K<sub class="key">pub</sub> will know that they could only have come form you.</li>
      </ol>
      With the usual Alice and Bob scenario, Alice's public key K<sup class="own">A</sup><sub class="key">pub</sub> is out there on the Internet, as is Bob's public key K<sup class="own">B</sup><sub class="key">pub</sub>. Alice "owns" K<sup class="own">A</sup><sub class="key">pub</sub> because she alone has the matching private key K<sup class="own">A</sup><sub class="key">priv</sub>. Similarly, Bob "owns" K<sup class="own">B</sup><sub class="key">pub</sub> because he alone has the matching private key K<sup class="own">B</sup><sub class="key">priv</sub>. This is illustrated by the diagram to the right. Following our usual plan, Alice sends Bob the plaintext message <em>msg</em> by:
      <p>
        <em>plaintext</em> <span style="font-size: 1.5em;">&mdash;</span> encrypt with
        K<sup class="own">A</sup><sub class="key">priv</sub>
        <span style="font-size: 1.5em;">&rarr;</span>
        <em>ciphertext1</em>
        <span style="font-size: 1.5em;">&mdash;</span>
        encrypt with
        K<sup class="own">B</sup><sub class="key">pub</sub>
        <span style="font-size: 1.5em;">&rarr;</span>
        <em>ciphertext2</em>
      </p>
      ... and she sends him <em>ciphertext2</em>. This works great, as long as Alice is really sure that K<sup class="own">B</sup><sub class="key">pub</sub> belongs to the person she knows as "Bob".  When that's no longer true, things get ugly.
    
      <img src="calendar.php-63.png?key=de316d4fe30334e785dec169ea14b3c05dbe11e5&type=lab&event=7" style="height: 240pt; float: left; clear: left;">
    <p>
      Suppose we have our usual enemy Eve throwing a public key K<sup class="own">A'</sup><sub class="key">pub</sub> up on the Internet and claiming it's Alice's public key, and throwing a public key K<sup class="own">B'</sup><sub class="key">pub</sub> up on the Internet and claiming it's Bob's public key. The diagram to the left illustrates this. Now Alice thinks she's encrypting her message with Bob's public key, but the public key K<sup class="own">B'</sup><sub class="key">pub</sub> she uses really belongs to Eve.  Eve then decrypts and reads the message, perhaps modifying it a bit, and then encrypts it using the real Bob's public key.  The real Bob receives the message none the wiser.
    </p>
    <p>
      What if Alice encrypts with her private key K<sup class="own">A</sup><sub class="key">priv</sub> first, and then with the key K<sup class="own">B'</sup><sub class="key">pub</sub> she thinks belongs to Bob?  Then Eve decrypts with her key K<sup class="own">B'</sup><sub class="key">priv</sub> followed by Alice's public key K<sup class="own">A</sup><sub class="key">pub</sub> and she has the plaintext message from Alice. Once again, she reads the message or changes it. Then Eve encrypts with her fake key K<sup class="own">A'</sup><sub class="key">priv</sub> first, and then with Bob's public key K<sup class="own">B</sup><sub class="key">pub</sub>. Bob is able to decrypt the plaintext message. Because doing so required K<sup class="own">A'</sup><sub class="key">pub</sub>, the key he believes to be Alice's public key, he thinks this message really must've come from Alice, and that nobody could have read it but himself.
    </p>
    <p>
      This is called a <em>Man-in-the-middle Attack</em>. Eve, obviously, is the "man-in-the-middle" here. Eve needs to pull off some kind of misdirection to make Alice believe K<sup class="own">B'</sup><sub class="key">pub</sub> really belongs to Bob, and to make Bob believe K<sup class="own">A'</sup><sub class="key">pub</sub> really belong to Alice.  But we've seen how to trick people with spam e-mails, misleading links, and convincing copies of web pages, which are a few possible ways to do this.
    </p>
        


        <p class="sec">
    <h2 style="clear: left;">Identity and web servers</h2>
    At first blush, the fact that Man-in-the-middle attacks work seems to indicate that RSA (or public key cryptography in general) has failed us.  After all, wasn't it supposed to provide a guarantee that if Alice sends Bob a message, Bob can be sure that message really did come from Alice? In fact, this is <em>not</em> what RSA/Asymmetric Encryption guarantee.  If Bob decrypts with his private key followed by the public key K<sub class="key">pub</sub>, he is only guaranteed that the message was really sent <em>by the owner of K<sub class="key">pub</sub></em>.  He has no guarantee of the <em>identity</em> of the owner
    of K<sub class="key">pub</sub>!

    So RSA has worked perfectly.  It's provided exactly the guarantee it said it would provide.  But we need something more in order to be safe from Man-in-the-middle attacks. What we need is a way to match <em>public keys</em> with <em>identities</em>.


<div style="float: right; clear: right; padding-left: 0.5em; padding-bottom: 0.5em;">
  <img title="Not sure why I just taught everyone to flawlessly impersonate me to pretty much anyone I know. Just remember to constantly bring up how cool it is that birds are dinosaurs and you&#39;ll be set." src="../../comics/identity.png" height="220pt"><br>
  <small><strong><a href="../../1121/index.htm">xkcd.com/1121/</a></strong></small>
      </div>

  <p>
      It's important to note that this is not merely a technical problem.  What constitutes "identity" is a social problem, and maybe even a philosophical, problem.  However, once we've decided what identity means, at least in a limited context, we need technical tools to help bind identities to public keys &mdash; a "public key infrastructure" (PKI).  The particular system we will look at is based on <em>X.509 Certificates</em>, and it's responsible for mapping identities to public keys in, for example, web browsing with HTTPS.
    </p>
  <p>
    Let's consider the problem of Man-in-the-middle Attacks on secure web communications, i.e. when using HTTPS.  A man-in-the-middle attack would look like this: you want to check your balance at the Navy Federal Credit Union, so you enter the URL <code>www.navyfcu.org</code> in your browser's address bar.  RSA is used to provide secure communications between your browser and the web server (actually, it's only used at the beginning in order to agree on a secret key for that session, after which symmetric encryption is used). A Man-in-the-middle attack would mean that the public key your browser thought belonged to <code>www.navyfcu.org</code> actually belongs to some bad guy. So what does "identity" mean in this context? <em>You</em> think you're communicating with Navy Federal Credit Union.  <em>Your browser</em> thinks it's communicating with <code>www.navyfcu.org</code>. <em>RSA</em> thinks it's communicating with public key <code>(4f32 .... 7e)</code>.  So there are different notions of who exactly we're communicating with.
      <ol>
        <li>RSA is responsible for secure, authenticated communication with public key <code>(4f32 .... 7e)</code>.</li>
        <li>The X.509 Certificate system is responsible for certifying that the public key <code>(4f32 .... 7e)</code> really belongs to domain name <code>www.navyfcu.org</code>.</li>
        <li>The user is responsible for knowing that the domain name <code>www.navyfcu.org</code> really belongs to the Navy Federal Credit Union.</li>
      </ol>
      In other words, X.509 Certificates certify the mapping of <em>domain names</em> to <em>public keys</em>.
    

        

        <div class="fleet" style="clear:both">
<h1>CAC Cards and DoD PKI</h1>

<p>
<div style="text-align:center">
  <img src="calendar.php-64.png?key=c2af7b34929b76bfc68db841f5eb92ba7ddac7f3&type=lab&event=7" width="100">
  <a href="calendar.php.pdf?key=0c2d00105ceb5a8465d32bc19c808283fa0d36d2&type=lab&event=7"><img src="calendar.php-65.png?key=23ec87abe54c8bb521b1a97e255a5b7a1000910e&type=lab&event=7" height="158"></a>
</div>


<p>Your CAC is a perfect real-world example that brings together a lot of what we talk about in the Models & Tools section of BRAND:
<i>Pillars of IA (Confidentiality, Authentication, and Non-Repudiation), Asymmetric Cryptography, identity and X.509.</i>
</p>

<p>Anyone who receives a CAC must sign<sup>*</sup> a DD Form 2842:</p>

<div style="margin-left:auto; margin-right:auto; width:28em; text-align: justify;">

  <i>
    <p>
      "You have been authorized to receive one or more <span style="color:#0000ff" ;=""><strong>private and public key pairs</strong></span> and associated <span style="color:#0000ff" ;=""><strong>certificates</strong></span>.
    </p>

    <p>"The certificates and private keys will be issued on a Common Access Card (CAC).</p>

    <p>
      "A private key enables you to <span style="color:#0000ff" ;=""><strong>digitally sign</strong></span> documents and messages and <span style="color:#0000ff" ;=""><strong>identify yourself</strong></span> to gain access to systems. You may have another private key to <span style="color:#0000ff" ;=""><strong>decrypt data</strong></span> such as encrypted messages.
    </p>

    <p>
      "People and electronic systems inside and outside the DoD will use public keys associated with your private keys to <span style="color:#0000ff" ;=""><strong>verify your digital signature</strong></span>, or to <span style="color:#0000ff" ;=""><strong>verify your identity</strong></span> when you attempt to <span style="color:#0000ff" ;=""><strong>authenticate</strong></span> to systems, or to <span style="color:#0000ff" ;=""><strong>encrypt data</strong></span> sent to you.
    </p>
  </i>
</div>

<p>
<sup>*</sup>Note: the DD2842 itself can be digitally signed!
</p>
<strong>DoD PKI Infrastructure</strong><br>
    The Department of Defense has its own Certificate Authorities. You can view and download them at DoD's PKI management site: <a href="../../index-25.htm"><code>https://crl.gds.disa.mil/</code></a>. The DoD PKI is managed by <a href="../../index-26.htm">DISA</a> (Defense Information Systems Agency).
</div>




        <p class="sec">
    <h2>X.509 Certificates ... a matter of trust</h2>
    X.509 is a standard for a Public Key Infrastructure. An X.509 Certificate is a file that a user or a program can use to verify that public key K really belongs to identity  I.  A Photo ID like a passport does a similar thing for you: it certifies that your name really belongs to your face. Provided a person assures himself that your passport is valid, i.e. not fake, he'll probably believe that your name really does belong to your face.  That belief is based on trust: a trust that the U. S. government probably wouldn't issue that passport to you unless the name in the passport was really yours.  X.509 certificates work the same way, they are issued by a <em>certificate authority</em>, and if you trust that certificate authority and you assure yourself of the validity of the certificate, then you trust that public key K really belongs to identity I.

    <p>
      Conceptually, a certificate has three pieces of information:
      <ul>
        <li><strong>subject's identity</strong> &mdash; in fact there are several pieces of information identifying the subject, but a simple string called the <em>common name</em> (<code>CN</code>) is the crucial part.  For a web server, the common name is the domain name.</li>
        <li><strong>subject's public key</strong> &mdash; in the certificates we looked at this was an RSA key.</li>
        <li><strong>issuer's identity</strong> &mdash; again, there are several pieces of information identifying the issuer, but a simple string called the <em>common name</em> (<code>CN</code>) is the crucial part.</li>
      </ul>
      Certificate authorities have certificates as well, and you need that certificate in order to to verify that a certificate is valid.  So a participant in this system
      keeps on hand the certificates of one or more certificate authorities it trusts.  When a certificate is received for some entity with whom he wants to communicate, he looks at the issuer's identity: if that matches the common name of one of the authorities he trusts, he'll take the certificate for the authority and use it to verify the new certificate.
    

        


        <p class="sec">
    <h2>A look at how, in principle, a certificate system works</h2>
    Let's add a new actor to our Alice/Bob/Eve play.  Suppose with have a fourth party named Cedric, who is trusted by both Alice and Bob.  Cedric has the public/private key-pair K<sup class="own">C</sup><sub class="key">pub</sub>/K<sup class="own">C</sup><sub class="key">priv</sub>, and Alice and Bob both know his public key.
    Suppose Alice presented Cedric with her name "Alice" and public key K<sup class="own">A</sup><sub class="key">pub</sub>, in such a way that Cedric was satisfied that he was really dealing with Alice.  Cedric could make a certificate by encrypting the string Alice:K<sup class="own">A</sup><sub class="key">pub</sub> with his private key, K<sup class="own">C</sup><sub class="key">priv</sub>. Alice could send Bob this certificate before they start encrypted communication.  Bob would decrypt with Cedric's
    public key K<sup class="own">C</sup><sub class="key">pub</sub>, and get the name Alice and the public key K<sup class="own">A</sup><sub class="key">pub</sub>.
    Because Bob knows that K<sup class="own">C</sup><sub class="key">pub</sub> really belongs to Cedric, he knows that the certificate really was created by Cedric &mdash; because it takes Cedric's private key to create something decryptable with his public key.  Moreover, since Bob <em>trusts</em> Cedric, he now believes that the key K<sup class="own">A</sup><sub class="key">pub</sub> belongs to the identity "Alice".
        


  <p class="sec">
    <h2>Certificates at the Naval Academy</h2>
    When you install a browser on your computer, that browser comes pre-installed with a fairly large number of certificate authorities that it trusts.  A wary user might
    want to winnow that down to only the certificate authorities that are absolutely necessary &mdash; i.e. minimize trust. So what authorities does someone at USNA need to trust?  Or at least, which authorities are we expected to trust? The interactive SI110 resource
    <div style="margin:
          1em;">
      <a href="http://courses.cyber.usna.edu/CYBERWAR/resources/06.certs/USNACertificates.html">
        Certificates at USNA</a></div>
    shows you what the certificate chain looks like for resources Navy Knowledge Online, BUPERS Online, MIDN, our CAC cards, and gozer.usna.edu (the authentication server for
    our gmail accounts).  If you trust <em>DoD Root CA 2</em> as DoD employees are supposed to, you will automatically trust the certificate for MIDN, for example, because it is signed by <em>DOD CA-27</em>, which your browser will trust because it is signed by <em>DoD Root CA 2</em>, which you trust. In other words, your browser will trust any certificate that "chains" back to the <em>DoD Root CA 2</em> certificate.
  

    <div class="sec">
      <h2>The Lab</h2>
      <div class="annotation">
        Your Instructor will let you know which of the following two labs to use:
        <ul>
          <li><a href="calendar.php-101.html?key=607d67f7406e34dd3a942663183788407bde3cd7&type=lab&event=7"><strong>X.509 Certificates Lab (condensed version)</strong></a></li>
          <li><a href="calendar.php-102.html?key=5b887490ddd7172472defbc0856d366172e03a17&type=lab&event=7">X.509 Certificates Lab</a>.</li>
        </ul>
      </div>
      <p>
        In this lab you will have the opportunity to see how X.509 certificates are used in HTTPS communication to verify the identities of the web servers we communicate with. Going through the activity, you will see what a real X.509 certificate looks like. You will see where the browser keeps its list of trusted authorities, and you will even see how certificates foil an attempted man-in-the-middle attack.
      </p>
    </div>
  <br><br><br><br>

  
  <div class="news">
    <strong>The Flame Malware: forging certificates</strong><br> Our discussion of certificates is centered around verifying the identity of a web server.  Certificates can be used to verify identities in other scenarios.  An important one is to identify the source of software (programs) and software updates. For instance, Windows has a mechanism to automatically pull updates (usually bug fixes!) over the internet and install them on your machine.  It's pretty darn important that you (or your computer, at any rate) can be certain that the update really came from Microsoft.  So the update comes with a certificate that proves that it's authentic.
    <p>
      In the Summer of 2012 a new piece of malware (malicious software, about which we will have much to say later!) was discovered on hundreds of machines in the Middle East, and given the name <em>Flame</em>. Security experts speculate that it was produced by either the government of the U.S. or of Israel. One of the many fascinating aspects of Flame is the way it gets onto hosts in the first place.  Basically, it pretends to be a  genuine Microsoft software update, so your computer willingly installs it.  Now, to do that, Flame needed a valid certificate that "proved" it really came from Microsoft.  So the authors of Flame forged a certificate by taking an actual valid certificate, and modifying it. But this isn't supposed to be possible!  A certificate is protected from modification by a hash that cannot be   changed. If the certificate data is modified, the hash value calculated by your computer, and that unchangeable hash value won't match.  The only way around this is to find a way to modify the certificate without changing the hash value &mdash; which is referred to as generating a hash "collision".  Well, that's what the Flame authors managed to do!  The Flame authors showed us not only that MD5 is "broken", in the sense that collisions can be found (which was already known), but that it's possible to modify data to read more or less however you want and still get an MD5 collision. That was impressive!
    </p>
  </div>
  <div class="news">
       <strong>Firefox Distrusts Major Certificate Authority</strong><br>
       In early 2018, Mozilla determined that Symantec, one of the oldest and largest Certificate Authorities, was not trustworthy and decided to slowly remove support for websites with certificates from them. Firefox slowly rolled out warnings and eventually removed the support entirely. This is significant because it affected a large number of sites; about 1% of the top million. Mozilla urged the operators of these websites to take action by obtaining new certificates so that they can still be accessed by Firefox users. This incident showcases how browsers are constantly evaluating their trust in Certificate Authorities.
    </div>
  <div class="news">
    <strong>When Certificate Authorities Go Bad</strong><br>
    When we install a certificate authority's certificate in our browser, we are saying "I trust the identify of any server with a certificate signed by you".  That's a big deal! Of course that means you trust the certificate authority to be honest (to do thorough background checks, refuse bribes, etc), but it also means you trust them to keep their systems secure. When a certificate authority you trust gets hacked, the attacker can issue fraudulent certificates ... which you will trust!  So when a certificate authority gets hacked, everyone pretty much loses confidence in them, and confidence is really the only thing a certificate authority
    sells.
    <p>
      In 2011, Dutch certificate authority DigiNotar was hacked, and the attacker issued a large number of fraudulent  certificates, including certificates that would allow him to pretend to be google!  Shortly after the security breach became public, DigiNotar filed for bankruptcy.
      The
      <a href="../../2011/09/diginotar-bankruptcy/index.htm">Wired Fall 2011 article</a> is a concise and easily readable description.
    </p>
  </div>
  <div class="news">
       <strong>Lenovo Laptops Pre-Loaded w/ Malicious Adware</strong><br>
       It was discovered in January 2015 that new Lenovo laptops were being shipped with pre-installed adware that hijacks encrypted web sessions, and may make their users vulnerable to HTTPS man-in-the-middle attacks.  The software installs a self-signed root HTTPS certificate that can intercept encrypted traffic for every website a user visits. When a user visits an HTTPS site, the site certificate is signed and controlled by Superfish and falsely represents itself as the official website certificate. Lenovo has released a statement stating that while this adware was installed on laptops shipped between October-December 2014, it has since stopped pre-loading this particular software onto it's laptops.  <strong>It should be noted that the USNA Class of 2016 was issued Lenovo laptops...presumably before this software was installed.</strong>
     </div>
  
  

    </body>
</html>
</div> <!-- /container --></body></html>